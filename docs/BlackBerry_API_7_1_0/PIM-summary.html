<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Frameset//EN""http://www.w3.org/TR/REC-html40/frameset.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc on Mon Jul 28 14:36:56 EDT 2008 -->
<TITLE>
BlackBerry Java SDK 7.0 API Reference: PIM
</TITLE>
<LINK REL ="stylesheet" TYPE="text/css" HREF="stylesheet.css" TITLE="Style">

<script type="text/javascript">
<!--
// switchMenu - Expand or collapse a code sample div. Takes two arguments:
// divSample, the id of the div to expand, divList
function switchMenu(divSample, sourceLink) {

	var el = document.getElementById(divSample).style;
	if (el.display == 'none') {
		el.display = 'block';
		sourceLink.className = 'explink_minus';
	} else {
		el.display = 'none';
		sourceLink.className = 'explink_plus';
	}
}

// collapseAll - Collapses all expandable divs and adds the + graphic automatically when the page loads.
// This is done so that users who do not have JS enabled can still see the code samples.
function collapseAll() {
	// Collapse all expandable divs
	var divsOnPage = document.getElementsByTagName('div');
	for (var x = 0; x < divsOnPage.length; x++) {
		if (divsOnPage[x].id.substr(0,3) == "UI_") {
		
			divsOnPage[x].style.display = 'none';
			
		}
	}
	// Change all the expand/collapse links to explink_plus, to show a plus sign beside it
	var linksOnPage = document.getElementsByTagName('a');
	for (var y = 0; y < linksOnPage.length; y++) {
		if (linksOnPage[y].className == "explink") {
			linksOnPage[y].className = "explink_plus";
		}
	}
}
//-->
</script>
</HEAD>
<BODY BGCOLOR="white" onLoad="collapseAll();">

<!-- ========== START OF NAVBAR ========== -->
<A NAME="navbar_top"><!-- --></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev">Package</FONT>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev">Class</FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="overview-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="index.html" TARGET="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="PIM-summary.html" TARGET="_top"><B>NO FRAMES</B></A></FONT></TD>
</TR>
</TABLE>
<!-- =========== END OF NAVBAR =========== -->
<HR>
<FORM action="https://www.blackberry.com/DocsFeedback/" method="GET" target="_new">
<INPUT type="hidden" name="title" value="API Reference">
<INPUT type="hidden" name="source" value="External">

<INPUT type="hidden" name="version" value="7.0.0">
<INPUT type="hidden" name="classname" value="PIM overview">
<INPUT type="submit" value="Submit Feedback" /></FORM>

<BR>


<h1 align="center">Personal Information Management (PIM) <a name="PIM_TOP"></a></h1>

<h2>Overview</h2>
<p>This document contains the packages required to access personal information management (PIM) data on a BlackBerry&reg; device. PIM data is defined as information included in address books, calendars, tasks, and memopads. The BlackBerry device fully supports the J2ME PIM implementation established in <a href="http://jcp.org/en/jsr/detail?id=75">JSR 75</a>, with a number of custom extensions.  
For more information, see the following sections: 
<ul>
  <li><a href="#PIM1">Understanding PIM interfaces </a></li>
  <li><a href="#PIM2">Working with PIM lists, items, and fields</a></li>
  <li><a href="#PIM3">Multiple calendar support</a></li>
  <li><a href="#PIM3a">Multiple contact list support</a> </li>
  <li><a href="#PIM4">Using BlackBerry PIM extensions</a></li>
  <li><a href="#PIM5">Performing Global Address List lookups</a></li>
  <li><a href="#PIM6">Launching PIM applications on a BlackBerry device</a> </li>
</ul>
<h2>Understanding PIM interfaces <a name="PIM1"></a> <a href="#PIM_TOP" class="backtotop">[back to top]</a></h2>
<p>The <a href="javax/microedition/pim/package-summary.html">javax.microedition.pim</a> package, which was introduced with JSR 75, provides a number of interfaces that allow you to access PIM data on a compliant mobile device. PIM data is organized into PIM lists, items, and fields. PIM lists are databases that contain all PIM items that can be accessed on a device. PIM lists maintain categories, which are logical groupings for the PIM items contained in the list. Each <span class="style2"><a href="javax/microedition/pim/PIMList.html">PIMList</a></span> object can support zero or more categories. Categories are represented by unique <span class="style2">String</span> names. </p>
<p><img src="images/Drawing17.jpg" border="0" usemap="#Map">
<map name="Map">
  <area shape="rect" coords="240,0,391,49" href="javax/microedition/pim/PIMList.html">
<area shape="rect" coords="3,94,147,141" href="net/rim/blackberry/api/pdap/BlackBerryPIMList.html">
<area shape="rect" coords="166,94,315,140" href="javax/microedition/pim/ContactList.html">
<area shape="rect" coords="335,95,485,143" href="javax/microedition/pim/EventList.html">
<area shape="rect" coords="502,93,650,142" href="javax/microedition/pim/ToDoList.html">
<area shape="rect" coords="168,173,316,219" href="net/rim/blackberry/api/pdap/BlackBerryContactList.html">
<area shape="rect" coords="335,220,482,265" href="net/rim/blackberry/api/pdap/BlackBerryEventList.html">
<area shape="rect" coords="503,264,650,312" href="net/rim/blackberry/api/pdap/BlackBerryToDoList.html">
<area shape="rect" coords="2,307,150,354" href="net/rim/blackberry/api/pdap/BlackBerryMemoList.html">
</map></p>
<p>&nbsp;</p>
<p>A <a href="javax/microedition/pim/PIMItem.html">PIMItem</a> object represents a collection of data for a single PIM entry. A PIM item is created from a particular PIM list and is associated with that list for the life of the item. PIM items can have its data imported and exported using standard byte based formats. Each implementing class defines what formats can be imported and exported for that item.</p>
<p><img src="images/PIMItems.jpg" border="0" usemap="#Map2">
  <map name="Map2">
    <area shape="rect" coords="416,-2,565,48" href="javax/microedition/pim/PIMItem.html">
    <area shape="rect" coords="3,92,150,140" href="javax/microedition/pim/Contact.html">
    <area shape="rect" coords="167,93,317,141" href="javax/microedition/pim/Event.html">
    <area shape="rect" coords="336,93,484,139" href="javax/microedition/pim/ToDo.html">
    <area shape="rect" coords="503,92,667,140" href="net/rim/blackberry/api/pdap/BlackBerryContactGroup.html">
    <area shape="rect" coords="684,94,834,139" href="net/rim/blackberry/api/pdap/BlackBerryMemo.html">
    <area shape="rect" coords="1,176,150,222" href="net/rim/blackberry/api/pdap/BlackBerryContact.html">
    <area shape="rect" coords="168,176,317,223" href="net/rim/blackberry/api/pdap/BlackBerryEvent.html">
    <area shape="rect" coords="335,177,484,222" href="net/rim/blackberry/api/pdap/BlackBerryToDo.html">
  <area shape="rect" coords="851,93,999,141" href="net/rim/blackberry/api/pdap/BlackBerryPIMItem.html">
  </map>
</p>
<p>A <span class="style2">PIMItem</span> is a grouping of related fields. Each field consists of a label, a data type, value(s), and attribute(s). Several examples are shown in the following table:</p>
<p><img src="images/PIM_Fields.jpg" width="853" height="102"> </p>
<p>For information on  specific field attributes  specifically for BlackBerry devices, see the section on <a href="#PIM4">using BlackBerry PIM extensions</a>.</p>
<p>For background information on PIM, see the <a href="http://jcp.org/en/jsr/detail?id=75">JSR 75 specification</a>. </p>
<h2>Working with PIM lists, items, and fields <a name="PIM2"></a> <a href="#PIM_TOP" class="backtotop">[back to top]</a></h2>
<h3>Adding PIM items to PIM lists</h3>
<p>The BlackBerry Java SDK API contains an interface that extends <a href="javax/microedition/pim/PIMItem.html" class="style2">PIMItem</a> for each of the core BlackBerry PIM applications: </p>
<table class="Small" width="599" border="1" CELLPADDING="3" CELLSPACING="0">
  <tr>
    <th width="213"><strong>BlackBerry application name </strong></th>
    <th width="213"><strong>PDAP interface name </strong></th>
  </tr>
  <tr>
    <td>Address Book </td>
    <td><a href="net/rim/blackberry/api/pdap/BlackBerryContact.html" class="style2">BlackBerryContact</a></td>
  </tr>
  <tr>
    <td>Calendar</td>
    <td><a href="net/rim/blackberry/api/pdap/BlackBerryEvent.html" class="style2">BlackBerryEvent</a></td>
  </tr>
  <tr>
    <td>MemoPad</td>
    <td><a href="net/rim/blackberry/api/pdap/BlackBerryMemo.html" class="style2">BlackBerryMemo</a></td>
  </tr>
  <tr>
    <td>Tasks</td>
    <td><a href="net/rim/blackberry/api/pdap/BlackBerryToDo.html" class="style2">BlackBerryToDo</a></td>
  </tr>
</table>
<p>To add a PIM item to a PIM list, invoke the relevant create method for the list type. For example, to add a contact to a contact list, create the contact instance, add the contact names, and invoke <a href="javax/microedition/pim/PIMItem.html#commit()" class="style2">PIMItem.commit()</a>. </p>
<table cellspacing="0" class="codesample" width="75%">
	<tr>
      <td>
      <pre><span id="support">Contact contact = contactList.createContact();
String[] name = new String[contactList.stringArraySize(Contact.NAME)];
contact.commit();</span></pre></td>
  </tr>
</table>
<h3>Adding PIM fields to PIM items</h3>
<p>You must first decide which labels, data types, and attributes to set, and then add those fields to the PIM item. For detailed information and sample code, see the section entitled &quot;Explicit Field Use with Field Checking&quot; in <a href="javax/microedition/pim/Contact.html" class="style2">javax.microedition.pim.Contact</a>, <a href="javax/microedition/pim/Event.html" class="style2">javax.microedition.pim.Event</a>, and <a href="javax/microedition/pim/ToDo.html" class="style2">javax.microedition.pim.ToDo</a>.</p>
<h3>Retrieving  field data and associated values from PIM items</h3>
<p> Invoke the relevant <span class="style2">PIMItem</span> <span class="style2">getXXX()</span> method to retrieve a particular value from a field. Always invoke <span class="style2"><a href="javax/microedition/pim/PIMItem.html#countValues(int)">PIMItem.countValues()</a></span> to check if a field has a value before invoking <span class="style2">getXXX()</span>, and  check if the fields are supported before using them. </p>
<p><strong>Note:</strong> Invoking <span class="style2">getXXX()</span> when <a href="javax/microedition/pim/PIMItem.html#countValues(int)" class="style2">countValues()</a> returns zero (0) throws  a <a href="java/lang/RuntimeException.html" class="style2">RuntimeException</a> (such as <a href="java/lang/IndexOutOfBoundsException.html" class="style2">IndexOutOfBoundsException</a>).</p>
<p><a class="explink" onClick="switchMenu('UI_11', this);">Click for code sample: Retrieve field data from PIM items</a></p>
<div id="UI_11" class="codesample">
<table cellspacing="0" class="codesample" width="75%">
	<tr>
      <td>
      <pre><span id="support">// Ensure that the NAME field has a value before invoking
// getStringArray().
if (contact.countValues(Contact.NAME) > 0)
{
    String[] name = contact.getStringArray(Contact.NAME, 0);
}

// Get EMAIL.
if (contact.countValues(Contact.EMAIL) > 0)
{
    String email = contact.getString(Contact.EMAIL, 0);
}

 
// Get the work phone.
final int numValues = contact.countValues(Contact.TEL);
for (int index = 0; index  < numValues; index++)
{
    final int curAttributes = contact.getAttributes(Contact.TEL, index);
    
    if ((curAttributes &amp; Contact.ATTR_WORK) == Contact.ATTR_WORK)
    {
        String phoneWork = contact.getString(Contact.TEL, index);            
    }
}

// Get the birthday.
if (contactList.isSupportedField(Contact.BIRTHDAY)) 
{
    long bday = contact.getDate(Contact.BIRTHDAY, 0);
}

 
// Get the access class. 
if (contactList.isSupportedField(Contact.CLASS)) 
{
    int class = contact.getInt(Contact.CLASS, 0);
}</span></pre></td>
  </tr>
</table>
</div>
<h3>Removing PIM items</h3>
<p> To remove a particular PIM item, call the remove item method on the appropriate PIM list. </p>
<p><a class="explink" onClick="switchMenu('UI_22', this);">Click for code sample: Remove PIM items</a></p>
<div id="UI_22" class="codesample">
<table cellspacing="0" class="codesample" width="75%">
  <tr>
      <td>
      <pre><span id="support">if(contact != null)
{
    try
    {
        contactList.removeContact(contact);
    }
 
    catch(PIMException e)
    {
        Dialog.alert("Contact does not exist");    
        e.printStackTrace();
    }
}</span></pre></td>
  </tr>
</table>
</div>


<h3>Importing and exporting PIM items</h3>
<p>Exporting is converting a <span class="style2">PIMItem</span> to a stream of bytes that can be imported by another PIM application. To export PIM data to a supported serial format, invoke <span class="style2"><a href="javax/microedition/pim/PIM.html#toSerialFormat(javax.microedition.pim.PIMItem, java.io.OutputStream, java.lang.String, java.lang.String)">PIM.toSerialFormat(PIMItem, OutputStream, String, String)</a></span>, passing as arguments an <span class="style2"><a href="java/io/OutputStream.html">OutputStream</a></span> to which the serialized <span class="style2">PIMItem</span> is written, the character encoding to use when writing to the output stream, and the supported data exchange format to convert to. Supported character encodings include &quot;UTF8,&quot; &quot;ISO-8859-1,&quot; and &quot;UTF-16BE.&quot;</p>
<p><a class="explink" onClick="switchMenu('UI_33', this);">Click for code sample: Export PIM Iitems</a></p>
<div id="UI_33" class="codesample">
<table cellspacing="0" class="codesample" width="75%">
  <tr>
      <td>
      <pre><span id="support">ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
Enumeration e = contactList.items();
    
    while (e.hasMoreElements())
    {
        Contact contact = (Contact) e.nextElement();
        pim.toSerialFormat(contact, outputStream, encoding, supportedSerialFormats[0]);
    }
}</span></pre></td>
  </tr>
</table>
</div>

<p>To import a <span class="style2">PIMItem</span>, invoke <span class="style2"><a href="javax/microedition/pim/PIM.html#fromSerialFormat(java.io.InputStream, java.lang.String)">fromSerialFormat(InputStream, String)</a></span>, passing as arguments the <span class="style2"><a href="java/io/InputStream.html">InputStream</a></span> from which the serialized <span class="style2">PIMItem</span> is written, and the character encoding to use. Supported character encodings include &quot;UTF8,&quot; &quot;ISO-8859-1,&quot; and &quot;UTF-16BE.&quot;</p>
<p><strong>Note: </strong>Only one <span class="style2">PIMItem</span> object can be decoded using a single <a href="javax/microedition/pim/PIM.html#fromSerialFormat(java.io.InputStream, java.lang.String)" class="style2">fromSerialFormat(InputStream, String)</a> invocation.</p>
<p><a class="explink" onClick="switchMenu('UI_44', this);">Click for code sample: Import contact items from an input stream</a></p>
<div id="UI_44" class="codesample">
<table cellspacing="0" class="codesample" width="75%">
  <tr>
      <td>
      <pre><span id="support">public void importContacts(InputStream inputStream, String transferEncoding, ContactList contactList) 
{
    PIMItem[] items = null;
    try
    {
        if(transferEncoding.equals(&quot;base64&quot;))
        {
            Base64InputStream b64is = new Base64InputStream(inputStream);
            items = pim.fromSerialFormat(b64is, "UTF-8");
        }
        else if (transferEncoding.equals("quoted-printable&quot;))
        {
            QuotedPrintableInputStream qpis = new QuotedPrintableInputStream(inputStream);
            items = pim.fromSerialFormat(qpis, "UTF-8");
        }
        else
        {
            InputStream is = new InputStream();
            items = pim.fromSerialFormat(is, &quot;UTF-8&quot;);
        }
        
        if (items != null)
        {
            // For each imported PIM contact item, import it into the contact list.
            for (int i = 0; i < items.length; i++) 
            {
                Contact contact = (Contact) (items[i]);
                Contact returnedContact = contactList.importContact(contact);
                // Ensure that the contact is saved into the list. 
                contact.commit();
            }
        }

    }

    catch(Exception e)
    {
        e.printStackTrace();
    }
}</span></pre></td>
  </tr>
</table>
</div>

<h2>Multiple calendar support <a name="PIM3"></a> <a href="#PIM_TOP" class="backtotop">[back to top]</a></h2>
<p>Beginning with BlackBerry Java SDK 4.5, you can access multiple calendars on a BlackBerry device. You can retrieve the names of each of the calendars on a device by invoking <span class="style2"><a href="javax/microedition/pim/PIM.html#listPIMLists(int)">PIM.listPIMLists(pimListType)</a></span>, passing <a href="javax/microedition/pim/PIM.html#EVENT_LIST" class="style2">PIM.EVENT_LIST</a> as the argument.</p>
<table cellspacing="0" class="codesample" width="75%">
  <tr>
    <td><pre><span id="support">String[] eventLists = pim.listPIMLists(PIM.EVENT_LIST);</span></pre></td>
  </tr>
</table>
<p>The <span class="style2">listPIMLists()</span> method returns a <span class="style2">String</span> array containing the names of each calendar. The first <span class="style2">String </span>item returned from <span class="style2">listPIMLists()</span> is the default calendar.</p>
<p>Services changes on the device can cause the default calendar to change. Implement <span class="style2"><a href="net/rim/blackberry/api/pdap/ListChangeListener.html">ListChangeListener</a></span> and specify it to <a href="net/rim/blackberry/api/pdap/BlackBerryPIM.html#addListChangeListener(net.rim.blackberry.api.pdap.ListChangeListener)" class="style2">BlackBerryPIM.addListChangeListener()</a> to be notified when the default calendar changes.  The <a href="net/rim/blackberry/api/pdap/ListChangeListener.html#defaultListChanged(int)" class="style2">defaultListChanged(listType)</a> method is invoked when the default PIM list of the specified type changes.</p>
<p>You can open a PIM list that combines multiple calendars on a BlackBerry device by invoking one of the <a href="net/rim/blackberry/api/pdap/BlackBerryPIM.html#openUnifiedPIMList(int, int)" class="style2">BlackBerryPIM.openUnifiedPIMList()</a> methods. </p>
<h2>Multiple contact list support <a name="PIM3a" id="PIM3a"></a> <a href="#PIM_TOP" class="backtotop">[back to top]</a></h2>
<p>Beginning with BlackBerry Java SDK 5.0, you can access multiple contact lists on a BlackBerry device. Each contact list has a name and a UID that you can use to access the list. You can change the contact list name by editing the name of the service associated with the name by using the BlackBerry Desktop Manager. You cannot change the UID.</p>
<p>Service changes on the device can cause the default contact list to change. Implement <span class="style2"><a href="net/rim/blackberry/api/pdap/ListChangeListener.html">ListChangeListener</a></span> and specify it to <a href="net/rim/blackberry/api/pdap/BlackBerryPIM.html#addListChangeListener(net.rim.blackberry.api.pdap.ListChangeListener)" class="style2">BlackBerryPIM.addListChangeListener()</a> to be notified when the default contact list changes.  The <a href="net/rim/blackberry/api/pdap/ListChangeListener.html#defaultListChanged(int)" class="style2">defaultListChanged(listType)</a> method is invoked when the default PIM list of the specified type changes.</p>
<p>You can retrieve the names of the contact lists on the BlackBerry device by invoking <span class="style2"><a href="javax/microedition/pim/PIM.html#listPIMLists(int)">PIM.listPIMLists(pimListType)</a></span>, passing <a href="javax/microedition/pim/PIM.html#CONTACT_LIST" class="style2">PIM.CONTACT_LIST</a> as the argument. </p>
<table cellspacing="0" class="codesample" width="75%">
  <tr>
    <td><pre><span id="support">String[] contactLists = pim.listPIMLists(PIM.CONTACT_LIST);</span></pre></td>
  </tr>
</table>
<p>The <span class="style2">listPIMLists()</span> method returns a <span class="style2">String</span> array containing the names for each contact list. The first <span class="style2">String </span>item returned from <span class="style2">PIM.listPIMLists()</span> is the default contact list. You can retrieve the UID of a contact list by invoking <a href="net/rim/blackberry/api/pdap/BlackBerryPIMList.html#getPIMListUID()" class="style2">BlackBerryPIMList.getPIMListUID()</a>. </p>
<p>You can open a contact list by its name by invoking <span class="style2"><a href="javax/microedition/pim/PIM.html#openPIMList(int, int, java.lang.String)">PIM.openPIMList(pimListType, mode, name)</a></span>. You can open a contact list by its UID by invoking <a href="net/rim/blackberry/api/pdap/BlackBerryPIM.html#openPIMList(int, int, long)" class="style2">BlackBerryPIM.openPIMList(pimListType, mode, uid)</a>.</p>
<p>You can open a PIM list that combines multiple contact lists on a BlackBerry device by invoking one of the <a href="net/rim/blackberry/api/pdap/BlackBerryPIM.html#openUnifiedPIMList(int, int)" class="style2">BlackBerryPIM.openUnifiedPIMList()</a> methods.</p>
<h3>Creating contact lists</h3>
<p>Since BlackBerry Java SDK 6.0, you can create contact lists by invoking <span class="style2"><a href="net/rim/blackberry/api/pdap/BlackBerryPIM.html#createPIMList(int, java.lang.String)">BlackBerryPIM.createPIMList(int type, String name)</a></span>. Currently, the type specified in <span class="style2">createPIMList()</span> must be <span class="style2"><a href="javax/microedition/pim/PIM.html#CONTACT_LIST">PIM.CONTACT_LIST</a></span> or <span class="style2"><a href="javax/microedition/pim/PIMException.html">PIMException</a></span> is thrown. Note the following about creating contact lists: </p>
<ul>
  <li> Each contact list has a unique UID, which is the value returned by <span class="style2">createPIMList()</span>. </li>
  <li> The contact lists do not have service records and do not support wireless synchronization, so you must manage these contact lists yourself, for example, backing up and restoring their data when needed. </li>
  <li> Applications can register to listen for changes to your contact list by invoking <span class="style2"><a href="net/rim/blackberry/api/pdap/BlackBerryPIMList.html#addListener(net.rim.blackberry.api.pdap.PIMListListener)">BlackBerryPIMList.addListener()</a></span>. </li>
</ul>
<p>You can also remove contact lists by invoking one of the <span class="style2"><a href="net/rim/blackberry/api/pdap/BlackBerryPIM.html#removePIMList(int, long)">BlackBerryPIM.removePIMList()</a></span> methods. Currently, these methods support PIM lists only of type <span class="style2">PIM.CONTACT_LIST</span>. Note the following about removing contact lists: </p>
<ul>
  <li> You cannot remove contact lists that have service records. </li>
  <li> You cannot remove the last remaining contact list on a device. </li>
  <li> You cannot remove the default contact list (which has the UID -1). </li>
  <li><span class="style2"><a href="net/rim/blackberry/api/pdap/BlackBerryPIMRemovalException.html">BlackBerryPIMRemovalException</a></span> is thrown if an error occurs when you try to remove a contact list. </li>
</ul>
<h2>Using BlackBerry PIM extensions<a name="PIM4"></a> <span class="style4"><a href="#PIM_TOP" class="backtotop">[back to top]</a></span> </h2>
<p>In addition to fully supporting the features in the <a href="javax/microedition/pim/package-summary.html">javax.microedition.pim</a> package, a number of BlackBerry PIM extensions are found in the <a href="net/rim/blackberry/api/pdap/package-summary.html" class="style2">net.rim.blackberry.api.pdap</a> package. The RIM extensions to the PIM API allow access to BlackBerry-specific features, including: </p>
<ul><li>read and write to MemoPad</li>
  <li>get and set recurrence for ToDo items</li>
  <li>set a standard UI for selecting a contact</li>
</ul>
<p>All BlackBerry-specific fields that are not supported by <a href="http://jcp.org/en/jsr/detail?id=75">JSR 75</a> are defined in the relevant <a href="net/rim/blackberry/api/pdap/BlackBerryContactList.html" class="style2">BlackBerrryContactList</a>, <a href="net/rim/blackberry/api/pdap/BlackBerryToDoList.html" class="style2">BlackBerryToDoList</a>, or <a href="net/rim/blackberry/api/pdap/BlackBerryEventList.html" class="style2">BlackBerryEventList</a> interface. </p>
<p>MemoPad is a BlackBerry application not supported by the J2ME PIM implementation. See <a href="net/rim/blackberry/api/pdap/BlackBerryMemoList.html" class="style2">BlackBerryMemoList</a> for more information and sample code for using the MemoPad. </p>
<p>To set recurrence for ToDo items, invoke <span class="style2"><a href="net/rim/blackberry/api/pdap/BlackBerryToDo.html#setRepeat(javax.microedition.pim.RepeatRule)">BlackBerryToDo.setRepeat()</a></span>, passing in a <a href="javax/microedition/pim/RepeatRule.html" class="style2">RepeatRule</a> object as a parameter to specify the recurrence. To get information on existing ToDo recurrence, invoke <a href="net/rim/blackberry/api/pdap/BlackBerryToDo.html#getRepeat()" class="style2">BlackBerryToDo.getRepeat()</a>, which returns a <a href="javax/microedition/pim/RepeatRule.html" class="style2">RepeatRule</a> object.</p>
<p>To display the standard user interface for adding contacts to a contact list, invoke the <span class="style2">choose()</span> method for the <span class="style2"><a href="net/rim/blackberry/api/pdap/BlackBerryContactList.html#choose()">BlackBerryContactList.choose()</a></span> method. </p>
<p><a class="explink" onClick="switchMenu('UI_55', this);">Click for code sample: Display a standard user interface for a contact list</a></p>
<div id="UI_55" class="codesample">
<table cellspacing="0" class="codesample" width="75%">
  <tr>
      <td>
      <pre><span id="support">public Contact askUserToChooseContact() 
{
    PIM pim = PIM.getInstance();
    BlackBerryContactList contactList = (BlackBerryContactList) 
        pim.openPIMList(PIM.CONTACT_LIST, PIM.READ_WRITE);
    return contactList.choose();
}</span></pre></td>
  </tr>
</table>
</div>
<h2>Performing Global Address List (GAL) lookups <a name="PIM5"></a> <a href="#PIM_TOP" class="backtotop">[back to top]</a></h2>
<p>You can design your application to allow BlackBerry device users to perform remote GAL lookups for contacts if your system uses a BlackBerry Enterprise Server (BES) as part of its messaging infrastructure. GAL lookups are performed by invoking <a href="net/rim/blackberry/api/pdap/BlackBerryContactList.html#lookup(javax.microedition.pim.Contact, net.rim.blackberry.api.pdap.RemoteLookupListener)" class="style2">BlackBerryContactList.lookup()</a>.  This method is overridden to accept either a <span class="style2">Contact</span> or a <span class="style2">String</span> as the search parameter.  The <a href="net/rim/blackberry/api/pdap/RemoteLookupListener.html#items(java.util.Enumeration)" class="style2">items()</a> method of the <a href="net/rim/blackberry/api/pdap/RemoteLookupListener.html" class="style2">RemoteLookupListener</a> object that is specified in the <span class="style2">lookup()</span> method is invoked when a result is returned from the BES.</p>
<p><a class="explink" onClick="switchMenu('UI_66', this);">Click for code sample: Do a GAL lookup</a></p>
<div id="UI_66" class="codesample">
<table cellspacing="0" class="codesample" width="75%">
  <tr>
      <td>
      <pre><span id="support">final class RemoteLookupDemo implements RemoteLookupListener
{
    public void items(Enumeration results)
    {
        int count = 0;	
        while (results.hasMoreElements())
        {
            results.nextElement();
            ++count;
        }
        System.out.println("Number of Contacts: " + count);
    }

    try
    {
        //retrieve an instance of PIM, open the contact list for read/write permissions
        BlackBerryContactList contactList = (BlackBerryContactList) 
            PIM.getInstance().openPIMList(PIM.CONTACT_LIST, PIM.WRITE_ONLY);
        //use the lookup method specifying the partial name
        //to perform the remote address lookup on
        contactList.lookup("Joe", this);
    }
 
    catch (Exception ex)
    {
        System.out.println(ex.toString());
    }
}</span></pre></td>
  </tr>
</table>
</div>
<h2>Launching PIM applications on a BlackBerry device <a name="PIM6"></a> <a href="#PIM_TOP" class="backtotop">[back to top]</a></h2>
<p>You can launch PIM applications by using the BlackBerry  <a href="net/rim/blackberry/api/invoke/package-summary.html" class="style2">Invoke</a> API.  For more information, see the <a href="App-Integration-summary.html">Application Integration</a> overview.
<HR>
<div id="legalnotice">
<table cellspacing="0" cellpading="0" width="100%" style="border:none;">
<tr>
<td style="border:none;">
<font size=-1>
<P>Copyright 1999-2011 Research In Motion Limited. 295 Phillip Street, Waterloo, Ontario, Canada, N2L 3W8. All Rights Reserved.<br>
Java is a trademark of Oracle America, Inc. in the US and other countries.</p>
</font>
</td>
<td style="text-align:right; border:none;">
<font size=-1><br>
<a href="http://www.blackberry.com/legal" target="_blank">Legal</a>
</font>
</td>
</tr>
</table>
 </div>
</BODY>
</HTML>
