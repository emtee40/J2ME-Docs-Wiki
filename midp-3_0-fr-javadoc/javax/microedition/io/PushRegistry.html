<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.5.0_20) on Mon Nov 02 17:27:39 PST 2009 -->
<TITLE>
PushRegistry (Mobile Information Device Profile 3.0)
</TITLE>

<META NAME="keywords" CONTENT="javax.microedition.io.PushRegistry class">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="PushRegistry (Mobile Information Device Profile 3.0)";
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/PushRegistry.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<strong>MIDP3.0</strong></EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../javax/microedition/io/IMCServerConnection.html" title="interface in javax.microedition.io"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../javax/microedition/io/PushRegistryPermission.html" title="class in javax.microedition.io"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?javax/microedition/io/PushRegistry.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="PushRegistry.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
javax.microedition.io</FONT>
<BR>
Class PushRegistry</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><B>javax.microedition.io.PushRegistry</B>
</PRE>
<HR>
<DL>
<DT><PRE>public class <B>PushRegistry</B><DT>extends java.lang.Object</DL>
</PRE>

<P>
<p>The <code>PushRegistry</code> maintains a list of inbound connections. A
 MIDlet can register the inbound connections with an entry in the
 application descriptor or dynamically by calling the
 <code>registerConnection</code> method.
 The connection strings are URIs that are used with <code>Connector.open</code>
 to open the appropriate server connection.</p>

 <p>While a MIDlet is running and has Connections open, it is responsible for
 all I/O operations associated with the inbound connection using the appropriate
 Generic Connection Framework API. When the MIDlet is not running or
 and MIDlet does not have the URI open, the application management software(AMS)
 listens for inbound notification requests. When a notification arrives for a
 registered MIDlet, the AMS will start the MIDlet, if necessary, via the normal
 invocation of <code>MIDlet.startApp</code> method.</p>

 <p>Implementations MUST guarantee that each inbound connection successfully
 registered (statically or dynamically) is logically unique. The logical
 uniqueness is determined by using the comparison ladder scheme as defined in
 <a href="../../../../overview.html#RFC3986">[RFC3986]</a>. Implementations MUST
 perform at least the simple string comparison, and SHOULD perform one or more
 of the latter steps of the comparison ladder scheme.</p>

 <H3>Installation Handling of Declared Connections</H3>

 <p>To avoid collisions on inbound generic connections, the application
 descriptor MUST include information about static connections that are
 needed by the MIDlet suite. If all the static Push declarations in the
 application descriptor can not be fulfilled during the installation, the user
 MUST be notified that there are conflicts and the MIDlet suite MUST NOT be
 installed. See
 <a href="../../../../provisioning.html#MIDP 3.0 Provisioning">MIDP 3.0 Provisioning</a> for
 errors reported in the event of conflicts. Conditions when the declarations
 can not be fulfilled include: syntax errors in the Push attributes, declaration
 for a connection end point (e.g. port number) that is already reserved in the
 device, declaration for a protocol that is not supported for Push in the device,
 and declaration referencing a MIDlet class that is not listed in the
 <code>MIDlet-&lt;n&gt;</code> attributes of the same application
 descriptor.</p>

 <p>If the MIDlet suite can function meaningfully even if a Push registration
 can not be fulfilled, it must register the Push connections using
 the dynamic registration with
 <A HREF="../../../javax/microedition/io/PushRegistry.html#registerConnection(java.lang.String, java.lang.String, java.lang.String)"><CODE>PushRegistry.registerConnection</CODE></A> method.</P>

 <P>A conflict-free installation reserves each requested connection for the
 exclusive use of a MIDlet in the suite. While the suite is installed, any
 attempt by other MIDlets to open one of the reserved connections will fail with
 an <code>IOException</code>. A call from a MIDlet to <code>Connector.open()</code>
 on a connection reserved for the MIDlet will always succeed, assuming the MIDlet
 does not already have the connection open.</P>

 <P>If two MIDlet Suites have a static push connection in common, they can not
 be installed together. The end user would typically have to delete one before
 being able to successfully install the other.</P>

 <H3><A NAME="PushAttr"></A>Static Push Registration</H3>

 <P>In some cases the MIDlet may not function properly if it cannot listen to
 a certain protocol or port for incoming traffic. The static push registration
 has been designed for these cases. The MIDlet that must have access to
 certain protocol or port announces this need in the application descriptor
 or in the JAR manifest. The implementation check already at installation time
 that the requested protocol or port is available and registers the MIDlet to
 listen to the incoming traffic. If the request cannot be fulfilled because
 protocol or port is already reserved, the installation of the application
 fails.</P>

 <P>Static Push registrations are done in the application descriptor or in the
 JAR manifest with <code>MIDlet-Push-&lt;n&gt;</code> attribute. Each push
 registration entry contains the following information:</p>
 <CODE><BLOCKQUOTE><strong>MIDlet-Push-</strong>&lt;n&gt;: &lt;ConnectionURI&gt;,
 &lt;MIDletClassName&gt;, &lt;AllowedSender&gt; </BLOCKQUOTE></CODE> where:
 <UL>
   <LI><code>MIDlet-Push-&lt;n&gt;</code> = the Push registration attribute name.
       Multiple Push registrations can be provided in a MIDlet suite. The numeric
       value for &lt;n&gt; starts from 1 and MUST use consecutive ordinal numbers
       for additional entries. The first missing entry terminates the list. Any
       additional entries are ignored. </LI>
   <LI><code>ConnectionURI</code> = the connection string used in
       <code>Connector.open()</code></LI>
   <LI><code>MIDletClassName</code> = the MIDlet that is responsible for the
       connection. The named MIDlet MUST be registered in the application descriptor
       or the JAR manifest with a <code>MIDlet-&lt;n&gt;</code> record. (This
       information is needed when displaying messages to the user about the MIDlet
       when Push connections are detected, or when the user grants/revokes
       privileges for the MIDlet.) If the named MIDlet appears more than once in
       the suite, the first matching entry is used. </LI>
   <LI> <code>AllowedSender</code> = a designated filter that restricts which
       senders are valid for launching the requested MIDlet. The syntax and semantics
       of the <code>AllowedSender</code> field depend on the addressing format used
       for the protocol. However, every syntax for this field MUST support using the
       wildcard characters "*" and "?". The semantics of those wildcard are:
       <UL>
         <LI> "*" matches any string, including an empty string </LI>
          <LI> "?" matches any single character </LI>
       </UL></LI>
 </UL>

 <P>When the value of <code>AllowedSender</code>field is just the wildcard character
 "*", connections will be accepted from any originating source. For Push attributes
 using the <CODE>datagram</CODE> and <CODE>socket</CODE> URIs (if supported by the
 platform), <code>AllowedSender</code> field contains a numeric IP address in the
 same format for IPv4 and IPv6 as used in the respective URIs (IPv6 address
 including the square brackets as in the URI). It is possible to use the wildcards
 also in these IP addresses, e.g. "129.70.40.*" would allow subnet resolution. The
 wildcards can also be used to match address delimiters, e.g. "72.5.1*" will match
 "72.5.124.161". Note that the port number is not part of the filter for
 <CODE>datagram</CODE> and <CODE>socket</CODE> connections. In every protocol,
 the <code>AllowedSender</code> field MUST match with the appropriate address field
 of the incoming event. The address field to use and the exact syntax and semantics
 of the address depend on the protocol. However, the address and the
 <code>AllowedSender</code> filter MUST be compared by exact string matching where
 the strings are compared character by character and the characters need to match
 exactly except as allowed by the two wildcard characters: asterisk(*) and question
 mark(?).</P>

 <P>This specification defines the syntax for <code>datagram</code> and
 <code>socket</code> inbound connections. When other specifications define
 Push semantics for additional connection types, they must define the expected
 syntax for the filter field, as well as the expected format for the
 connection URI string.</P>

 <H4>Example Application Descriptor Declarative Notation</H4>

 <P>The following is a sample application descriptor entry that would reserve a
 stream socket at port 79 and a datagram connection at port 50000. (Port numbers are
 maintained by IANA and cover well-known, user-registered and dynamic port
 numbers) [See <a href="http://www.iana.org/assignments/port-numbers"> IANA Port
 Number Registry</a>]</P>

 <PRE>
 MIDlet-Push-1: socket://:79, com.sun.example.SampleChat, *
 MIDlet-Push-2: datagram://:50000, com.sun.example.SampleChat, *
 </PRE>

 <H3>Dynamic Push Registration from a Running MIDlet</H3>

 <P>There are cases when defining a well known port registered with IANA is not
 necessary. Simple MIDlets may just wish to exchange data using a private
 protocol between a MIDlet and server MIDlet.</P>

 <P>To accommodate this type of MIDlet, a mechanism is provided to dynamically
 allocate a connection and to register that information, as if it was known, when
 the MIDlet was installed. This information can then be sent to an agent on the
 network to use as the mechanism to communicate with the registered MIDlet.</P>

 <P>For instance, if a <A HREF="../../../javax/microedition/io/UDPDatagramConnection.html" title="interface in javax.microedition.io"><CODE>UDPDatagramConnection</CODE></A> is
 opened and a port number, was not specified, then the MIDlet is requesting a
 dynamic port to be allocated from the ports that are currently available. By
 calling <code>PushRegistry.registerConnection()</code> method the MIDlet informs
 the AMS that it is the target for inbound communication, even after the MIDlet
 has been destroyed. (See MIDlet life cycle for definition of "destroyed" state).
 Once the MIDlet has registered the connection with <code>PushRegistry.registerConnection</code>
 method, the connection is listed in the <code>PushRegistry.listConnetions(false)</code>
 return value. If the MIDlet has an open connection to the registered connection,
 the AMS starts listening to the inbound connection once the connection has been
 closed with <code>Connector.close</code> method. If the MIDlet is deleted from
 the phone, then its dynamic communication connections are unregistered automatically.</P>

 <H3>AMS Connection Handoff</H3>

 <P>Responsibility for registered Push connections is shared between the AMS and
 the MIDlet that handles the I/O operations on the inbound connection. To prevent
 any data from being lost, a MIDlet is responsible for all I/O operations on the
 connection from the time it calls <code>Connector.open()</code> until it calls
 <code>Connection.close()</code>.</P>

 <P>The AMS listens for inbound connection notifications. This MAY be handled via
 a native callback or polling mechanism looking for new inbound data. The AMS
 is responsible for enforcing the <A HREF="package-summary.html#push">Security
 of PushRegistry</A> and presenting notifications (if any) to the user before
 invoking the MIDlet suite.</P>

 <P>The AMS is responsible for the shutdown of any running MIDlets (if
 necessary) prior to the invocation of the push MIDlet</code>.</P>

 <P>After the AMS has started the Push application, the MIDlet is responsible for
 opening the connections and for all subsequent I/O operations. A MIDlet that
 needs to perform blocking I/O operations SHOULD use a separate thread to allow
 for interactive user operations. Once the MIDlet has been started and the connection
 has been opened, the AMS is no longer responsible for listening for Push
 notifications for that connection. The MIDlet is responsible for reading all
 inbound data.</P>

 <P>If a MIDlet has finished with all inbound data it MAY the connection with
 <code>Connector.close()</code> method. If the connection is closed, then
 the AMS resumes listening for Push notifications. This avoids the loss of data
 that might occur if neither the MIDlet nor the AMS was listening.</P>

 <p>When a registered Push MIDlet is not running the AMS listens for incoming
 connections and launches the MIDlet as necessary. If a Push MIDlet exits and
 there are incoming connections, either new or unhandled, for the MIDlet, then
 the MIDlet MUST be started to handle the available input.</p>

 <P>A Push MIDlet SHOULD behave in a predictable manner when handling asynchronous
 data via the Push mechanism. A well behaved MIDlet SHOULD inform the user that
 data has been processed. (While it is possible to write MIDlets that do not use
 any user visible interfaces, this could lead to a confused end user experience
 to launch a MIDlet that only performs a background function.)</P>

 <H3>AMS Runtime Handling</H3>

 <P>During installation, each MIDlet that is expecting inbound communication on a
 well known address has the information recorded with the AMS from the Push
 registration attribute in the manifest or application descriptor. Once the
 installation has been successfully completed, (e.g. via provisioning - when the
 <em>Installation notification message</em> has been
 successfully transmitted, the MIDlet is officially installed) the MIDlet may
 then receive inbound communication. e.g. the Push notification event.</P>

 <P>When the AMS is started, it checks the list of registered connections and
 begins listening for inbound communication. When a notification arrives the
 AMS starts the registered MIDlet. The MIDlet then opens the connection with
 <code>Connector.open()</code> method to perform whatever I/O operations are
 needed for the particular connection type. e.g. for a server socket the MIDlet uses
 <code>acceptAndOpen()</code> to get the socket connected and for a datagram
 connection the MIDlet uses <code>receive()</code> to read the delivered message.</P>

 <P>For message oriented transports the inbound message may be read by the AMS
 and saved for delivery to the MIDlet when it requests to read the data. For
 stream oriented transports the connection may be lost if the connection is not
 accepted before the server end of the connection request timeouts.</P>

 <P>When a MIDlet is started in response to a registered Push connection notification,
 it is platform dependent what happens to the current running MIDlet. The MIDlet
 life cycle defines the expected behaviors that an interrupted MIDlet could see
 from a call to <code>destroyApp()</code>.</P>

 <H3>Buffered Messages</H3>

 <P>The requirements for buffering of messages are specific to each protocol used
 for Push and are defined separately for each protocol. There is no general
 requirement related to buffering that would apply to all protocols. If the
 implementation buffers messages, these messages MUST be provided to the MIDlet
 when the MIDlet is started and it opens the related <code>Connection</code>
 that it has registered for Push.</P>

 <P>When datagram connections are supported with Push, the implementation MUST
 guarantee that when a MIDlet registered for datagram Push is started in response
 to an incoming datagram, at least the datagram that caused the startup of the
 MIDlet is buffered by the implementation and MUST be available to the MIDlet
 when the MIDlet opens the <code>UDPDatagramConnection</code> after startup.</P>

 <P>When socket connections are supported with Push, the implementation MUST
 guarantee that when a MIDlet registered for socket Push is started in response
 to an incoming socket connection, this connection can be accepted by the MIDlet
 by opening the <code>ServerSocketConnection</code> after startup, provided that the
 connection hasn't timed out meanwhile.</P>

 <H3>Connection vs Push Registration Support</H3>

 <P>Not all generic connections will be appropriate for use as Push application
 transport. Even if a protocol is supported on the device as an inbound connection
 type, it is not required to be enabled as a valid Push mechanism. E.g. a platform
 might support server socket connections in a MIDlet, but might not support
 inbound socket connections for Push launch capability. A
 <code>ConnectionNotFoundException</code> is thrown from the
 <code>registerConnection</code> method
 when the platform does not support that optional capability.
 The <code>registerAlarm</code> method MUST be supported.</P>

 <H3>Sample Usage Scenarios</H3>

 <P><strong>Usage scenario 1:</strong> The suite includes a MIDlet with a well
 known port for communication. During the <code>startApp</code> processing a
 thread is launched to handle the incoming data. Using a separate thread is the
 recommended practice for avoiding conflicts between blocking I/O operations and
 the normal user interaction events. The thread continues to receive messages until
 the MIDlet is destroyed.</P>

 <H4>Sample Chat Application Descriptor</H4>

 <P>In this sample, the application descriptor includes a static Push connection
 registration. It also includes an indication that this MIDlet requires permission
 to use a datagram connection for inbound push messages. (See
 <A HREF="package-summary.html#push">Security of Push Functions</A> in the package
 overview for details about MIDlet permissions.) <strong>Note:</strong> this sample
 is appropriate for bursts of datagrams. It is written to loop on the connection,
 processing received messages.</P>

 <PRE>
 MIDlet-Name: SunNetwork - Chat Demo
 MIDlet-Version: 1.0
 MIDlet-Vendor: Sun Microsystems, Inc.
 MIDlet-Description: Network demonstration programs for MIDP
 MicroEdition-Profile: MIDP-3.0
 MicroEdition-Configuration: CLDC-1.1
 MIDlet-1: InstantMessage, /icons/Chat.png, example.chat.SampleChat, *
 MIDlet-Push-1: datagram://:79, example.chat.SampleChat, *
 MIDlet-Permission-1: javax.microedition.io.PushRegistry "datagram://"
 MIDlet-Permission-2: javax.microedition.io.Connector "datagram://"
 </PRE>

 <H4>Sample Chat MIDlet Processing</H4>

 <PRE>
 public class SampleChat extends MIDlet {
   // Current inbound message connection.
   DatagramConnection conn;

   // Flag to terminate the message reading thread.
   boolean done_reading;

   public void startApp() {
     // List of active connections.
     String connections[];

     // Check to see if this session was started due to
     // inbound connection notification.
     connections = PushRegistry.listConnections(true);

     // Start an inbound message thread for available
     // inbound messages for the statically configured
     // connection in the application descriptor.
     for (int i=0; i &lt; connections.length; i++) {
       Thread t = new Thread (new MessageHandler(connections[i]));
       t.start();
     }
     ...
   }

   // Stop reading inbound messages and release the push
   // connection to the AMS listener.
   public void destroyApp(boolean conditional) {
     done_reading = true;
     if (conn != null) conn.close();
     // Optionally, notify network service that we're done
     // with the current session. ...
   }

   // Inner class to handle inbound messages on a separate thread.
   class MessageHandler implements Runnable {
     String connUrl ;
     MessageHandler(String uri) {
       connUri = uri ;
     }

     // Fetch messages in a blocking receive loop.
     public void run() {
       try {
         // Get a connection handle for inbound messages
         // and a buffer to hold the inbound message.
         DatagramConnection conn =
           (DatagramConnection) Connector.open(connUri);
         Datagram data = conn.newDatagram(conn.getMaximumLength());

         // Read the inbound messages
         while (!done_reading) {
           conn.receive(data); ...
         }
       } catch (IOException ioe) {
         ...
       }
        ...
     }
   }
 }
 </PRE>

 <P><strong>Usage scenario 2:</strong> The suite includes a MIDlet that
 dynamically allocates port the first time it is started.</P>

 <H4>Sample Ping Application Descriptor</H4>

 <P>In this sample, the application descriptor includes an entry indicating that
 the MIDlet will need permission to use the datagram connection for inbound Push
 messages. The dynamic connection is allocated in the constructor the first time
 it is run. The open connection is used during this session and can be reopened
 in a subsequent session in response to a inbound connection notification.</P>

 <PRE>
 MIDlet-Name: SunNetwork - Demos
 MIDlet-Version: 1.0
 MIDlet-Vendor: Sun Microsystems, Inc.
 MIDlet-Description: Network demonstration programs for MIDP
 MicroEdition-Profile: MIDP-3.0
 MicroEdition-Configuration: CLDC-1.1
 MIDlet-1: JustCallMe, /icons/Ping.png, example.ping.SamplePingMe, *
 MIDlet-Permission-1: javax.microedition.io.PushRegistryPermission "datagram:"  "static,dynamic"
 MIDlet-Permission-2: javax.microedition.io.DatagramProtocolPermission "datagram://"
 </PRE>

 <H4>Sample Ping MIDlet Processing</H4>

 <PRE>
 public class SamplePingMe extends MIDlet {
   // Name of the current MIDlet for push registration.
   String myName = "example.chat.SamplePingMe";

   // List of registered push connections.
   String connections[];

   // Inbound datagram connection
   UDPDatagramConnection dconn;

   public SamplePingMe() {
     // Check to see if the ping connection has been registered.
     // This is a dynamic connection allocated on first
     // time execution of this MIDlet.
     connections = PushRegistry.listConnections(false);

     if (connections.length == 0) {
       // Request a dynamic port for out-of-band notices.
       // (Omitting the port number let's the system allocate
       // an available port number.)
       try {
         dconn = (UDPDatagramConnection)
           Connector.open("datagram://");
         String dport = "datagram://:" + dconn.getLocalPort();

         // Register the port so the MIDlet will wake up, if messages
         // are posted after the MIDlet exits.
         PushRegistry.registerConnection(dport, myName, "*");

         // Post my datagram address to the network ...
       } catch (IOException ioe) {
         ...
       } catch (ClassNotFoundException cnfe) {
         ...
       }
     }
   }

   public void startApp() {
     // Open the connection if it's not already open.
     if (dconn == null) {
       // This is not the first time this is run, because the
       // dconn hasn't been opened by the constructor.
       // Check if the startup has been due to an incoming datagram.
       connections = PushRegistry.listConnections(true);

       if (connections.length &gt; 0) {
         // There is a pending datagram that can be received.
         dconn = (UDPDatagramConnection) Connector.open(connections[0]);

         // Read the datagram
         Datagram d = dconn.newDatagram(dconn.getMaximumLength());
         dconn.receive(d);
       } else {
         // There are not any pending datagrams, but open
         // the connection for later use.
         connections = PushRegistry.listConnections(false);
         if (connections.length &gt; 0) {
           dconn = (UDPDatagramConnection) Connector.open(connections[0]);
         }
       }
     }
   }

   public void destroyApp(boolean unconditional) {
     // Close the connection before exiting
     if(dconn != null) {
       dconn.close();
       dconn = null;
     }
   }
   ...
 }
 </PRE>
<P>

<P>
<DL>
<DT><B>Since:</B></DT>
  <DD>MIDP 2.0</DD>
</DL>
<HR>

<P>

<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/io/PushRegistry.html#getFilter(java.lang.String)">getFilter</A></B>(java.lang.String&nbsp;connection)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Retrieve the registered filter for a requested connection.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/io/PushRegistry.html#getMIDlet(java.lang.String)">getMIDlet</A></B>(java.lang.String&nbsp;connection)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Retrieve the registered MIDlet for a requested connection.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;java.lang.String[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/io/PushRegistry.html#listConnections(boolean)">listConnections</A></B>(boolean&nbsp;available)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return a list of registered connections for the current MIDlet.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;long</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/io/PushRegistry.html#registerAlarm(java.lang.String, long)">registerAlarm</A></B>(java.lang.String&nbsp;midlet,
              long&nbsp;time)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Register a time to launch the specified MIDlet.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/io/PushRegistry.html#registerConnection(java.lang.String, java.lang.String, java.lang.String)">registerConnection</A></B>(java.lang.String&nbsp;connection,
                   java.lang.String&nbsp;midlet,
                   java.lang.String&nbsp;filter)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Register a dynamic connection with the application management software.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../javax/microedition/io/PushRegistry.html#unregisterConnection(java.lang.String)">unregisterConnection</A></B>(java.lang.String&nbsp;connection)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remove a dynamic connection registration.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>equals, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="registerConnection(java.lang.String, java.lang.String, java.lang.String)"><!-- --></A><H3>
registerConnection</H3>
<PRE>
public static void <B>registerConnection</B>(java.lang.String&nbsp;connection,
                                      java.lang.String&nbsp;midlet,
                                      java.lang.String&nbsp;filter)
                               throws java.lang.ClassNotFoundException,
                                      java.io.IOException</PRE>
<DL>
<DD><p>Register a dynamic connection with the application management software.
 Once registered, the dynamic connection acts just like a connection
 preallocated from the application descriptor.</p>

 <p>While the MIDlet has opened the connection with <code>Connector.open()</code>,
 the AMS will NOT be listening for input. The MIDlet is responsible for the
 connection. If the MIDlet has not opened a connection to the registered URI,
 the AMS MUST listen for input regardless of whether the MIDlet is running
 or not.</p>

 <P>The arguments for the dynamic connection registration are the same as the
 <A HREF="#PushAttr">Push Registration Attribute</A> used for static
 registrations.</P>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>connection</CODE> - the URI for the connection<DD><CODE>midlet</CODE> - class name of the <code>midlet</code> to be launched when
            new external data is available. The named <code>midlet</code>
            MUST be registered in the application descriptor or the JAR
            manifest with a MIDlet-&lt;n&gt; record. This parameter has
            the same semantics as the <code>MIDletClassName</code> in the Push
            registration attribute defined in the class description.<DD><CODE>filter</CODE> - a connection URI string indicating which senders are allowed
            to cause the <code>midlet</code> to be launched
<DT><B>Throws:</B>
<DD><CODE>java.lang.IllegalArgumentException</CODE> - if the connection string is <code>null</code> or is not valid,
            or if the filter string is <code>null</code> or not valid
<DD><CODE>ConnectionNotFoundException</CODE> - if the runtime system does not support push delivery for
            the requested connection protocol
<DD><CODE>java.io.IOException</CODE> - if the connection is already registered or if there are
            insufficient resources to handle the registration request
<DD><CODE>java.lang.ClassNotFoundException</CODE> - if <code>midlet</code> is <code>null</code> or
            if the <code>midlet</code> class name can not be found
            in the current <code>midlet</code> suite or if this
            class is not included in any of the MIDlet-&lt;n&gt;
            records in the application descriptor or the JAR manifest
<DD><CODE>java.lang.SecurityException</CODE> - if the <code>midlet</code> does not have permission to
            register a connection<DT><B>See Also:</B><DD><A HREF="../../../javax/microedition/io/PushRegistry.html#unregisterConnection(java.lang.String)"><CODE>unregisterConnection(java.lang.String)</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="unregisterConnection(java.lang.String)"><!-- --></A><H3>
unregisterConnection</H3>
<PRE>
public static boolean <B>unregisterConnection</B>(java.lang.String&nbsp;connection)</PRE>
<DL>
<DD>Remove a dynamic connection registration.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>connection</CODE> - the URI for the connection
<DT><B>Returns:</B><DD><code>true</code> if the unregistration was successful,
         <code>false</code> if the connection was not registered or if
         the connection argument was <code>null</code>
<DT><B>Throws:</B>
<DD><CODE>java.lang.SecurityException</CODE> - if the connection was registered by another MIDlet suite<DT><B>See Also:</B><DD><A HREF="../../../javax/microedition/io/PushRegistry.html#registerConnection(java.lang.String, java.lang.String, java.lang.String)"><CODE>registerConnection(java.lang.String, java.lang.String, java.lang.String)</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="listConnections(boolean)"><!-- --></A><H3>
listConnections</H3>
<PRE>
public static java.lang.String[] <B>listConnections</B>(boolean&nbsp;available)</PRE>
<DL>
<DD><p>Return a list of registered connections for the current MIDlet.</p>

 <p>The URI of every registered connection is returned from
 <code>listConnections(false)</code>.</p>

 <p>The URI of every connection that has available input is returned from
 <code>listConnections(true)</code>. URI's of connections opened with
 <code>Connector.open(URI)</code> are not returned. After the <code>Connection</code>
 is closed new input may become available and the URI will again be included
 in the return of <code>listConnections(true)</code>. URIs of connections
 that timeout or otherwise no longer have available input are not returned
 from <code>listConnections(true)</code>. Due to race conditions, a call to
 <code>listConnections(true)</code> may return URIs that will fail to open
 with <code>Connector.open</code> because timeouts or other connection errors.</p>

 <p>When the MIDlet opens the URI, the MIDlet takes over listening for input
 and the AMS stops listening. The <code>listConnections(true)</code> method
 will only see URIs with available input during the time that the MIDlet does
 NOT have the connection open.</p>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>available</CODE> - if <code>true</code>, only return the list of connections
            ready for the handoff to the MIDlet,
            otherwise return the complete list of
            registered connections for the current MIDlet
<DT><B>Returns:</B><DD>array of registered connection strings, where each connection is
         represented by the generic connection URI string.</DL>
</DD>
</DL>
<HR>

<A NAME="getMIDlet(java.lang.String)"><!-- --></A><H3>
getMIDlet</H3>
<PRE>
public static java.lang.String <B>getMIDlet</B>(java.lang.String&nbsp;connection)</PRE>
<DL>
<DD>Retrieve the registered MIDlet for a requested connection.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>connection</CODE> - a registered generic connection URI string
<DT><B>Returns:</B><DD>class name of the MIDlet to be launched when new
         external data is available, or <code>null</code> if the
         connection was not registered by the current MIDlet
         or if the connection argument was <code>null</code><DT><B>See Also:</B><DD><A HREF="../../../javax/microedition/io/PushRegistry.html#registerConnection(java.lang.String, java.lang.String, java.lang.String)"><CODE>registerConnection(java.lang.String, java.lang.String, java.lang.String)</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="getFilter(java.lang.String)"><!-- --></A><H3>
getFilter</H3>
<PRE>
public static java.lang.String <B>getFilter</B>(java.lang.String&nbsp;connection)</PRE>
<DL>
<DD>Retrieve the registered filter for a requested connection.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>connection</CODE> - a registered generic connection URI string
<DT><B>Returns:</B><DD>a filter string indicating which senders are allowed to cause the
         MIDlet to be launched or <code>null</code>, if
         the connection was not registered by the current
         MIDlet or if the connection argument was
         <code>null</code><DT><B>See Also:</B><DD><A HREF="../../../javax/microedition/io/PushRegistry.html#registerConnection(java.lang.String, java.lang.String, java.lang.String)"><CODE>registerConnection(java.lang.String, java.lang.String, java.lang.String)</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="registerAlarm(java.lang.String, long)"><!-- --></A><H3>
registerAlarm</H3>
<PRE>
public static long <B>registerAlarm</B>(java.lang.String&nbsp;midlet,
                                 long&nbsp;time)
                          throws java.lang.ClassNotFoundException,
                                 javax.microedition.io.ConnectionNotFoundException</PRE>
<DL>
<DD><p>Register a time to launch the specified MIDlet. The <code>PushRegistry</code>
 supports one outstanding wake up time per MIDlet in the current suite. A
 MIDlet is expected to use <code>java.util.TimerTask</code> for notification
 of time based events while the MIDlet is running.</p>

 <P>If a wakeup time was registered and is still pending, the wakeup time
 will be returned, otherwise zero is returned.  If the wakeup time has passed
 then the wakeup is no longer pending and zero is returned.
 </P>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>midlet</CODE> - class name of the <code>midlet</code> within the current
            running MIDlet suite to be launched, when the
            alarm time has been reached. The named MIDlet
            MUST be registered in the application descriptor or the JAR
            manifest with a <code>MIDlet-&lt;n&gt;</code> record. This parameter has
            the same semantics as the <code>MIDletClassName</code> in the Push
            registration attribute defined above in the class description.<DD><CODE>time</CODE> - time at which the <code>midlet</code> is to be executed in
            the format returned by <code>Date.getTime()</code>.
            If the time is zero, or is in the past, or the MIDlet
            is already running at the <code>time</code> then
            the MIDlet MUST not be launched.
<DT><B>Returns:</B><DD>the time at which the most recent execution of this
         <code>midlet</code> was scheduled to occur, in the format
         returned by <code>Date.getTime()</code>
<DT><B>Throws:</B>
<DD><CODE>ConnectionNotFoundException</CODE> - if the runtime system does not support alarm based
                application launch
<DD><CODE>java.lang.ClassNotFoundException</CODE> - if the <code>midlet</code> class name can not be found
                in the current <code>midlet</code> suite or if this
                class is not included in any of the <code>MIDlet-&lt;n&gt;</code>
                records in the application descriptor or the JAR manifest or
                if the <code>midlet</code> argument is <code>null</code>
<DD><CODE>java.lang.SecurityException</CODE> - if the <code>midlet</code> does not have permission to
                register an alarm<DT><B>See Also:</B><DD><CODE>Date.getTime()</CODE></DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/PushRegistry.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<strong>MIDP3.0</strong></EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../javax/microedition/io/IMCServerConnection.html" title="interface in javax.microedition.io"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../javax/microedition/io/PushRegistryPermission.html" title="class in javax.microedition.io"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?javax/microedition/io/PushRegistry.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="PushRegistry.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
<font size=-1><a href=mailto:jsr-271-comments@jcp.org>Send a comment or suggestion</a>Version 3.0 of Mobile Information Device Profile Specification<br>Java is a trademark or registered trademark of Sun Microsystems, Inc. in the US and other countries. Copyright 2002-2009 Motorola Inc. Portions copyright 1993-2002 Sun Microsystems, Inc. and Motorola, Inc. All Rights Reserved.</font>
</BODY>
</HTML>
